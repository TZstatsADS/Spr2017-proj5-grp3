---
title: "R Notebook"
output: html_notebook
---



Step 0: load the raw data, load the age 9 features, extract age 9 data
```{r}

raw=read.csv("~/Documents/FFChallenge/background.csv",header=TRUE)
features<-colnames(raw)

codebooks<-c("child","mom","dad","teacher")
data.info<-vector()

for (i in codebooks){
feat.table<-read.csv(paste0("~/GitHub/Spr2017-proj5-grp3/data/ff_",i,"_cb9.csv"),header=FALSE)
feat.table<-feat.table[,-1]
feat.table<-feat.table[-1,]
feat.table<-cbind(rep(i,nrow(feat.table)),feat.table)
data.info<-rbind(data.info,feat.table)
}

colnames(data.info)<-c("class","code","description")
data.info=as.data.frame(data.info)
featnum<-nrow(data.info)
extract.feature<-features %in% data.info$code  
sum(extract.feature)
extract.data<-raw[,extract.feature]
extract.data<-cbind(challengeID=raw[,1],extract.data)
posi.data<-extract.data[,-col(extract.data)<0]
write.csv(extract.data,file = "~/GitHub/Spr2017-proj5-grp3/data/extractdata.csv")
```


```{r}
label<-read.csv("~/Documents/FFChallenge/train.csv")

label.train<-label[,1:2]
label.train=na.omit(label.train)
trainIndex=extract.data$challengeID %in% label.train$challengeID
data.train<-extract.data[trainIndex,]

```


```{r}
library(e1071)
library(tree)

set.seed (1)
i.train = sample(1:nrow(data.train), nrow(data.train)*0.75)
dtrain=data.train[i.train,]
dtest=data.train[-i.train,]
ltrain=label.train$gpa[i.train]
dt=cbind(ltrain,dtrain[,-1])

tree.ff=tree(as.numeric(ltrain)~.,data=dt)

cv.d <- cv.tree(tree.boston,FUN = prune.misclass)
prune.d <- prune.misclass(tree.boston,best = 7)
tree.pred <- predict(prune.d,subset(dtest,select=-y), type = "class")
error <- mean(tree.pred != dtest$y)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).
